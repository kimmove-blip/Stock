# 장중매매 최적화 전략 v2.0

생성일: 2026-02-03
분석 기간: 2026-01-19 ~ 2026-02-03 (약 2주)
데이터: 177,020 장중 스코어 샘플, 437 거래 로그

---

## Executive Summary

5단계 연구 분석 결과, 현재 전략 대비 **승률 31.7% → 78.3%**, **월간 수익 +160%** 개선이 가능한 최적화 전략을 도출했습니다.

### 핵심 변경 사항

| 항목 | 현재 | 최적화 | 예상 효과 |
|------|------|--------|----------|
| 매수 시간대 | 09:10~15:10 | **09:30~11:30** | 승률 +26%p |
| 손절선 | -7% | **-3%** | 수익 +160% |
| 상승률 필터 | 없음 | **≤3%** | 승률 80% |
| V5 홀딩 임계값 | ≥60 | **≥70** | 갭손실 회피 |

---

## 1. 종목선정 (Score 기준)

### 1.1 스코어 예측력 순위

| 순위 | 스코어 | 상관계수 | 용도 |
|------|--------|----------|------|
| 1 | **V5** | r=0.2286 | 최강 예측력, 주 신호 |
| 2 | V2 | r=0.1874 | 추세 필터 |
| 3 | V4 | r=0.1434 | 수급 안정성 |
| 4 | V1 | r=0.0518 | 사용 비권장 |

### 1.2 최적 진입 신호

**Tier 1 (최고 신뢰도)**: V5Δ≥10 + V2Δ≥10
- 승률: **94.3%**
- 평균 수익: **+2.576%**
- 발생 빈도: 주 35건

**Tier 2 (고신뢰도)**: V5Δ≥10 + V4Δ≥10
- 승률: **95.6%**
- 평균 수익: **+3.308%**
- 발생 빈도: 주 14건

**Tier 3 (표준)**: V5Δ≥10 단독
- 승률: **82.3%**
- 평균 수익: **+0.858%**
- 발생 빈도: 주 290건

### 1.3 역발상 필터 (V2 높고 V1 낮음)

```
V2 >= 70 AND V1 < 50
```
- 이유: V2(추세) 강하지만 V1(종합)이 낮은 종목은 저평가 상태
- 10~11시 승률: **56%**, 평균 수익: **+1.0%**

### 1.4 상승률 필터 (신규 추가)

```
당일 상승률 <= 3%
```
- 이미 급등한 종목 추격매수 방지
- 필터 적용 시 승률: **80%** (미적용 시 56%)

---

## 2. 매수 시기

### 2.1 시간대별 성과 분석

| 시간대 | 승률 | 평균 수익 | 권장 |
|--------|------|----------|------|
| 09:00~09:30 | 25.6% | -1.65% | **제외** |
| **09:30~10:00** | **63.8%** | **+1.38%** | **핵심** |
| **10:00~10:30** | **58.3%** | **+0.87%** | **핵심** |
| **10:30~11:00** | **53.0%** | **+0.93%** | **핵심** |
| **11:00~11:30** | **60.5%** | **+1.27%** | **핵심** |
| 11:30~12:00 | 50.7% | +0.98% | 보통 |
| 12:00~15:00 | 38~42% | +0.0~0.5% | 축소 |

### 2.2 최적 매수 시간대

```
핵심 시간대: 09:30 ~ 11:30 (2시간)
```

**이유**:
- 09:00~09:30: 장 초반 노이즈, 승률 25.6%
- 09:30~11:30: 평균 승률 **57.3%**, 추세 형성 구간
- 12:00 이후: 승률 급락 (38~42%)

### 2.3 오전 전략 (09:30~10:55)

```python
# 보수적 진입 조건
V2 >= 70 AND V1 < 50 AND V4 >= 50 AND change_pct <= 5%
```

### 2.4 기본 전략 (11:00~11:30)

```python
# 역발상 + 상승률 필터
V2 >= 70 AND V1 < 50 AND V4_DELTA <= 0 AND change_pct <= 3%
```

---

## 3. 매도 시기

### 3.1 홀딩 조건 (매도 보류)

| 우선순위 | 조건 | 효과 |
|---------|------|------|
| 1 | **V5 >= 70** | 오버나잇 +2.22% (vs 60-70: -8.51%) |
| 2 | V4 >= 55 | 수급 강세 |
| 3 | V2 >= 60 | 추세 유지 |

### 3.2 매도 조건

| 우선순위 | 조건 | 이유 |
|---------|------|------|
| 1 | **손익률 <= -3%** | 조기 손절 (기존 -7%에서 강화) |
| 2 | V4 < 40 | 수급 약화 |
| 3 | V2 < 50 AND V4 < 45 | 복합 약세 |
| 4 | V5 < 40 | 패턴 소멸 |

### 3.3 장마감 정리매도 (15:00~)

```python
if V5 >= 70:
    HOLD  # 익일 갭상승 기대
elif V5 < 70:
    SELL  # 정리매도
```

### 3.4 매도 시점 최적화

| 시간대 | 평균 손익 | 권장 |
|--------|----------|------|
| **09시대** | **-0.19%** | **최적** |
| 10시대 | -0.95% | 양호 |
| 11시대 | -2.30% | 지양 |
| 15시대 | -1.81% | 마감정리 |

**결론**: 매도 조건 충족 시 **오전 조기 매도**가 유리

---

## 4. 손절/익절

### 4.1 손절선: -3% (기존 -7%에서 강화)

| 손절선 | 수익 개선 | 발동 횟수 |
|--------|----------|----------|
| **-3%** | **+218,749원 (+160%)** | 43회 |
| -5% | +91,073원 | 25회 |
| -7% | +11,290원 | 11회 |
| -10% | 효과 없음 | 3회 |

### 4.2 익절 목표: 미설정 권장

| 목표가 | 수익 변화 |
|--------|----------|
| +3% | -89,058원 (손실) |
| +5% | -52,391원 (손실) |
| +7% | -30,001원 (손실) |
| **없음** | **최적** |

**이유**: 조기 익절로 추가 상승 기회 상실

### 4.3 트레일링 스탑: 미사용 권장

- 장중 변동성에서 불필요한 청산 발생
- 고점 대비 -2~5% 모두 수익 감소 효과

### 4.4 스코어 기반 동적 청산

```python
# 즉시 매도 조건
if V4 < 40:  # 수급 급락
    SELL
if V4_DELTA <= -10:  # V4 급락 (승률 4.9%)
    SELL
if V5_DELTA <= -15:  # V5 급락 (승률 14.1%)
    SELL
```

---

## 5. 최적화 전략 요약

### 5.1 매수 조건 (최종)

```python
def should_buy_optimized(stock, scores, change_pct, hour, minute):
    v1, v2, v4, v5 = scores['v1'], scores['v2'], scores['v4'], scores['v5']
    v4_delta = scores.get('v4_delta', 0)

    # 시간대 필터: 09:30 ~ 11:30만
    if hour < 9 or (hour == 9 and minute < 30):
        return False, "장 초반 노이즈 구간"
    if hour > 11 or (hour == 11 and minute > 30):
        return False, "핵심 시간대 종료"

    # 상승률 필터 (신규)
    if change_pct > 3.0:
        return False, f"상승률 {change_pct}% > 3% (추격매수 방지)"

    # 오전 전략 (09:30~10:55)
    if hour < 11:
        if v2 >= 70 and v1 < 50 and v4 >= 50:
            return True, f"[오전] V2={v2}, V1={v1}, V4={v4}"

    # 기본 전략 (11:00~11:30)
    else:
        if v2 >= 70 and v1 < 50 and v4_delta <= 0:
            return True, f"[기본] V2={v2}, V1={v1}, V4Δ={v4_delta}"

    return False, "조건 미충족"
```

### 5.2 매도 조건 (최종)

```python
def should_sell_optimized(stock, scores, pl_rate, is_closing):
    v2, v4, v5 = scores['v2'], scores['v4'], scores['v5']

    # 1. 손절 (-3%)
    if pl_rate <= -3.0:
        return True, f"손절 {pl_rate:.1f}%"

    # 2. 홀딩 조건 (V5 >= 70)
    if v5 >= 70:
        return False, f"V5={v5} 홀딩"

    # 3. 수급 홀딩 (V4 >= 55)
    if v4 >= 55:
        return False, f"V4={v4} 홀딩"

    # 4. 매도 조건
    if v4 < 40:
        return True, f"V4={v4}<40 매도"
    if v2 < 50 and v4 < 45:
        return True, f"V2={v2}<50, V4={v4}<45 매도"

    # 5. 장마감 정리 (V5 < 70)
    if is_closing and v5 < 70:
        return True, f"장마감정리 V5={v5}<70"

    return False, "홀딩 유지"
```

### 5.3 예상 성과

| 지표 | 현재 | 최적화 | 개선 |
|------|------|--------|------|
| 승률 | 31.7% | **78.3%** | +46.6%p |
| 평균 수익률 | +0.20% | **+2.42%** | +2.22%p |
| 월간 수익 | +68,966원 | **+179,344원** | +160% |

---

## 6. 구현 체크리스트

### 6.1 auto_trader.py 수정

- [ ] Line 217: V2 >= 65 → 70
- [ ] Line 222: V2 < 65 → 70
- [ ] Line 230: V2 < 70 → 75 (문서 일치) 또는 70 유지
- [ ] 손절선: -7% → **-3%**
- [ ] V5 홀딩: 60 → **70**
- [ ] 시간대: 09:10 → **09:30** 시작
- [ ] 시간대: 15:10 → **11:30** 종료 (핵심 시간대만)
- [ ] 상승률 필터: change_pct <= 3% 추가

### 6.2 리스크 관리

- 최대 보유 종목: 20개 유지
- 종목당 투자금: 나스닥 연동 조정 유지
- 일일 최대 손실: -5% 시 신규 매수 중단

---

## 7. 한계 및 주의사항

1. **분석 기간 제한**: 2주간 데이터 (장기 추세 미반영)
2. **시장 상황 미분류**: 상승장/하락장 구분 없음
3. **거래비용 부분 반영**: 0.203% 포함했으나 슬리피지 미반영
4. **백테스트 vs 실전**: 실전에서는 성과 차이 가능

---

*Generated from 5-stage research analysis*
*Data: 177,020 intraday scores, 437 trades*
*Statistical methods: Pearson correlation, Welch's t-test, Cohen's d*
