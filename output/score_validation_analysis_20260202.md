# 스코어 유효성 검증 분석 리포트

**분석 일자**: 2026-02-02
**분석 대상**: 2026-02-02, 2026-01-30 거래 내역

---

## 1. 핵심 발견사항

### 1.1 V2 스코어와 수익률 상관관계 없음

| 날짜 | 상관계수 | 승률 | 평균수익률 |
|------|---------|------|-----------|
| 2026-02-02 | +0.011 | 23.7% | -1.75% |
| 2026-01-30 | -0.062 | 21.7% | -1.39% |

**결론**: 높은 V2 스코어가 높은 수익을 보장하지 않음

### 1.2 V2 구간별 성과 (2026-02-02)

| V2 구간 | 건수 | 승률 | 평균수익률 |
|---------|------|------|-----------|
| 65-69 | 9건 | 22.2% | -2.47% |
| 70-74 | 6건 | 0.0% | -3.39% |
| 75-79 | 12건 | 25.0% | -1.28% |
| 80-100 | 8건 | 37.5% | -0.91% |

**문제점**: V2 70-74 구간이 승률 0%로 가장 나쁨

### 1.3 스코어 불안정성 (2026-02-02)

- **V2 장중 평균 표준편차**: 7.3점
- **V2 장중 평균 변동폭**: 39.4점
- **매수 후 V2 하락 비율**: 84.6%
- **매수 후 평균 V2 변화**: -18.0점

**문제점**: 매수 종목의 대부분이 매수 후 스코어 급락

### 1.4 시간대별 성과 (2026-02-02)

| 시간대 | 건수 | 승률 | 평균수익률 |
|--------|------|------|-----------|
| 09시 | 24건 | 25.0% | -1.61% |
| 10시 | 5건 | 0.0% | -4.55% |
| 11시 | 5건 | 20.0% | -1.11% |
| 12시+ | 4건 | 50.0% | +0.09% |

**문제점**: 오전 매수(09-11시) 성과가 현저히 나쁨

### 1.5 V2 >= 70 종목 수 추이

| 시간 | 종목 수 | 비고 |
|------|--------|------|
| 09:10 | 5개 | 장 시작 |
| 12:00 | 5개 | - |
| 15:00 | 1개 | 장 마감 (-80%) |

**문제점**: 오전 고점수 종목이 장중 스코어 하락하며 급감

---

## 2. 권장 개선사항

### 2.1 매수 시간 제한 (우선순위: 높음)

```python
# 현재
if v2_score >= 70:
    buy()

# 개선안
if v2_score >= 70 and current_hour >= 11:  # 또는 13
    buy()
```

- 09:00~10:30 매수 금지 또는 신중
- 11:00 이후 또는 13:00 이후 매수 검토

### 2.2 스코어 안정성 필터 추가 (우선순위: 높음)

```python
# 연속 2~3개 시간대에서 V2 >= 70 유지 확인
def check_score_stability(code, scores_history):
    recent_scores = get_last_n_scores(code, n=3)
    return all(s >= 70 for s in recent_scores)
```

- 단일 시점 고점수만으로 매수하지 않음
- 최소 15~30분 동안 고점수 유지 확인

### 2.3 V2 임계값 상향 (우선순위: 중간)

| 현재 | 개선안 | 근거 |
|------|--------|------|
| V2 >= 70 | V2 >= 80 | 80+ 구간 승률 37.5%로 상대적 우수 |

### 2.4 V2 상승 추세 필터 (우선순위: 중간)

```python
# V2 상승 추세인 종목만 매수
def check_v2_trend(code, scores_history):
    prev_v2 = get_score(code, time=-1)
    curr_v2 = get_score(code, time=0)
    return curr_v2 - prev_v2 >= 5  # 5점 이상 상승
```

### 2.5 V2 70-74 구간 제외 (우선순위: 높음)

- 2026-02-02 기준 V2 70-74 구간 승률 0%
- 70-74 구간 매수 제외 또는 추가 조건 부여

---

## 3. 구현 제안

### auto_trader.py 수정 예시

```python
def should_buy(stock_code, v2_score, current_time, scores_history):
    """개선된 매수 조건"""

    # 1. 기본 V2 조건 (상향)
    if v2_score < 75:  # 70 → 75
        return False

    # 2. 시간 필터
    hour = current_time.hour
    if hour < 11:  # 09:00~10:59 매수 금지
        return False

    # 3. 스코어 안정성
    recent = get_recent_scores(stock_code, n=2)
    if len(recent) < 2 or any(s < 70 for s in recent):
        return False

    # 4. V2 상승 추세
    if len(recent) >= 2 and recent[-1] - recent[-2] < 3:
        return False

    # 5. 위험 구간 제외
    if 70 <= v2_score < 75:  # 70-74 구간 제외
        return False

    return True
```

---

## 4. 후속 분석 필요사항

1. **더 많은 거래일 분석**: 패턴 일관성 추가 검증
2. **개선안 백테스트**: 시뮬레이션으로 개선 효과 검증
3. **V4, V5 스코어 활용도 분석**: 다른 스코어와 조합 효과
4. **손절/익절 타이밍 분석**: 청산 전략 최적화

---

## 5. 요약

| 문제 | 원인 | 해결책 |
|------|------|--------|
| 낮은 승률 (20~24%) | 오전 모멘텀 추격 매수 | 11시 이후 매수 |
| 스코어-수익 무관 | 스코어 불안정 | 안정성 필터 |
| V2 급락 | 단일 시점 매수 | 연속 고점수 확인 |
| 70-74 최악 | 경계값 문제 | 75+ 또는 80+ |

---

## 6. 복합 지표 선행지표 분석 (추가)

### 6.1 개별 지표-수익률 상관계수

| 지표 | 상관계수 | 해석 |
|------|---------|------|
| V2 | +0.011 | 거의 무관 |
| V5 | +0.120 | 약한 양의 관계 |
| V4 델타 | **-0.436** | **강한 음의 관계 (핵심!)** |
| 등락률 변화 | -0.299 | 음의 관계 |
| V1 | -0.188 | 약한 음의 관계 |

### 6.2 핵심 발견: 역발상 지표 효과

#### V4 델타 역발상
- V4 델타 > 0 (상승중): 승률 **0%**, 평균 -3.91%
- V4 델타 ≤ 0 (정체/하락중): 승률 28.6%, 평균 -1.37%

→ **V4가 급상승 중인 종목은 피하고, 안정/하락 중인 종목 선호**

#### V1 역발상 (V2>=75 기준)
| V1 구간 | 승률 | 평균수익률 |
|---------|------|-----------|
| 0-30 | **100%** | **+2.31%** |
| 30-40 | 50% | +1.75% |
| 40-50 | 28.6% | -1.75% |
| 50-60 | 0% | -2.58% |
| 60-100 | 0% | -3.37% |

→ **V1이 낮을수록 (역발상) 더 좋은 성과!**

### 6.3 최고 성과 복합 조건

| 순위 | 조건 | 승률 | 평균수익률 |
|------|------|------|-----------|
| 1 | V2>=75 & V1<50 & 등락률변화<0 | **57.1%** | **+0.95%** |
| 2 | V2>=75 & V1<50 & V4델타<=0 | 50.0% | +0.23% |
| 3 | V2>=75 & V1<50 & V5>=50 | 57.1% | +0.43% |

### 6.4 피해야 할 조건

| 조건 | 승률 | 평균수익률 |
|------|------|-----------|
| V4델타 > 0 | 0% | -3.91% |
| 등락률변화 > 3% | 0% | -5.34% |
| V5델타 < -5 | 0% | -3.91% |
| V2>=75 & V1>=60 | 0% | -3.37% |

### 6.5 권장 매수 조건 (개선안)

```python
def should_buy_advanced(code, curr, prev):
    """복합 지표 기반 매수 조건"""

    v2 = curr['v2']
    v1 = curr['v1']
    v4_delta = curr['v4'] - prev['v4']
    change_delta = curr['change_pct'] - prev['change_pct']

    # 1. 기본 V2 조건
    if v2 < 75:
        return False

    # 2. V1 역발상 조건 (핵심!)
    if v1 >= 50:
        return False

    # 3. V4 안정/하락 확인
    if v4_delta > 0:
        return False

    # 4. 모멘텀 둔화 확인
    if change_delta > 0:
        return False

    return True
```

### 6.6 기대 효과

| 구분 | 승률 | 평균수익률 |
|------|------|-----------|
| 현재 (단순 V2>=70) | 23.7% | -1.75% |
| 개선 후 (복합 조건) | 50~57% | +0.2~1.0% |

**예상 개선율: 승률 2배 이상, 수익률 양전환 가능**

---

---

## 7. 매도 타이밍 분석

### 7.1 현재 매도 성과

- 매도 후 평균 **+0.98% 상승** → 전체적으로 매도가 너무 빨랐음
- 손절 종목 26.1%가 매도 후 상승 → 일부 손절이 너무 일찍
- 익절 종목 41.7%가 매도 후 상승 → 더 홀딩했으면 좋았음

### 7.2 핵심 발견: V5가 높으면 팔지 마라!

| V5 구간 | 건수 | 매도 후 변화 | 조치 |
|---------|------|-------------|------|
| V5 >= 60 | 7건 | **+12.50%** | 절대 매도 금지 |
| V5 < 60 | 28건 | -1.91% | 매도 적절 |

### 7.3 스코어별 매도 후 추이

| 매도 시점 스코어 | 매도 후 변화 | 해석 |
|-----------------|-------------|------|
| V2 >= 60 | +9.01% | 너무 빨리 팔음 |
| V2 40-50 | -0.25% | 적절 |
| V4 >= 60 | +8.49% | 너무 빨리 팔음 |
| V4 < 40 | -5.42% | 더 빨리 팔아야 |

### 7.4 최적 매도 조건

```python
def should_sell(v2, v4, v5, profit_pct, current_hour, current_minute):
    '''개선된 매도 조건'''

    # 1. 강제 손절
    if profit_pct <= -7:
        return True, "손절"

    # 2. 장 마감 정리
    if current_hour >= 15 and current_minute >= 20:
        return True, "장마감"

    # 3. V5 높으면 홀딩 (핵심!)
    if v5 >= 60:
        return False, "V5>=60 홀딩"

    # 4. V4 높으면 홀딩
    if v4 >= 55:
        return False, "V4>=55 홀딩"

    # 5. V2 높으면 홀딩
    if v2 >= 60:
        return False, "V2>=60 홀딩"

    # 6. 매도 조건
    if v2 < 50 and v4 < 45:
        return True, "매도"

    return False, "홀딩"
```

### 7.5 매도 조건 요약

**매도 보류 (반드시 홀딩)**
- V5 >= 60 → 절대 매도 금지
- V4 >= 55 → 매도 보류
- V2 >= 60 → 매도 보류

**즉시 매도**
- V4 < 40 → 즉시 매도
- V2 < 50 AND V4 < 45 → 즉시 매도
- 수익률 -7% 이하 → 손절

---

## 8. 종합 전략

### 8.1 매수 조건 (개선)

```
V2 >= 75 AND V1 < 50 AND 등락률변화 < 0
또는
V2 >= 75 AND V1 < 50 AND V4델타 <= 0
```

예상 승률: 50~57%

### 8.2 매도 조건 (개선)

```
홀딩: V5 >= 60 OR V4 >= 55 OR V2 >= 60
매도: (V2 < 50 AND V4 < 45) OR V4 < 40 OR 손절(-7%)
```

예상 추가 수익: V5>=60 홀딩 시 +12.50%

### 8.3 기대 효과

| 구분 | 현재 | 개선 후 |
|------|------|--------|
| 매수 승률 | 23.7% | 50~57% |
| 매도 타이밍 | 너무 빠름 (+0.98%) | V5 기반 홀딩 |
| 종합 | -1.75% | +0.5~2.0% 예상 |

---

*분석 생성: 2026-02-02 21:45*
*복합 지표 분석 추가: 2026-02-02 22:00*
*매도 타이밍 분석 추가: 2026-02-02 22:15*
